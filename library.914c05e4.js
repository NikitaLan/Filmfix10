!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},a=t.parcelRequired7c6;null==a&&((a=function(e){if(e in n)return n[e].exports;if(e in r){var t=r[e];delete r[e];var a={id:e,exports:{}};return n[e]=a,t.call(a.exports,a,a.exports),a.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){r[e]=t},t.parcelRequired7c6=a);document.querySelector(".btn-queue"),document.querySelector(".gallery-library__list"),document.querySelector(".empty");var o=a("bpxeT"),c=a("2TvXO"),d=a("kPudI"),i=a("4mCOx"),u=a("juZTq"),s=(o=a("bpxeT"),c=a("2TvXO"),a("jVDuT")),l=a("gIqCw"),v={watchedBtn:document.querySelector(".btn-watched"),queueBtn:document.querySelector(".btn-queue"),watchedList:document.querySelector(".gallery-library__list"),textOoops:document.querySelector(".empty")},h="https://api.themoviedb.org/3/movie/",f="3dd9518c386fd347d5f1ac2580a699a4",p=1,m=function(e){try{var t=localStorage.getItem(e);return null===t?void 0:JSON.parse(t)}catch(e){console.error("Get state error: ",e.message)}};v.watchedBtn.addEventListener("click",w),v.watchedBtn.classList.add("active"),v.watchedBtn.addEventListener("click",(function(){v.watchedBtn.classList.add("active"),v.queueBtn.classList.remove("active")})),v.queueBtn.addEventListener("click",(function(){v.queueBtn.classList.add("active"),v.watchedBtn.classList.remove("active")})),window.addEventListener("load",w),v.queueBtn.addEventListener("click",(function(){if(p=2,!L)return v.textOoops.classList.remove("visually-hidden"),void(v.watchedList.innerHTML="");if(0===L.length)return v.textOoops.classList.add("visually-hidden"),void(v.watchedList.innerHTML="");S(L)}));var y=m("watched"),L=m("queue");function w(){return p=1,y?0===y.length?(v.textOoops.classList.add("visually-hidden"),void(v.watchedList.innerHTML="")):void S(y):(v.textOoops.classList.remove("visually-hidden"),void(v.watchedList.innerHTML=""))}function g(e){return b.apply(this,arguments)}function b(){return(b=e(o)(e(c).mark((function t(n){var r,a;return e(c).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(h).concat(n,"?api_key=").concat(f,"&language=en-US"));case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function q(e){return x.apply(this,arguments)}function x(){return(x=e(o)(e(c).mark((function t(n){var r,a;return e(c).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.map((function(e){return g(e)})),e.next=3,Promise.all(r);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function S(e){return T.apply(this,arguments)}function T(){return(T=e(o)(e(c).mark((function t(n){var r,a,o;return e(c).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(e){return e.reduce((function(e,t){return e+(0,s.makeLibraryGalleryMarkUp)(t)}),"")},e.next=3,q(n);case 3:if(r=e.sent,console.log(r),0!==r.length){e.next=9;break}return v.textOoops.classList.remove("visually-hidden"),v.watchedList.innerHTML='<div class="empty">\n<p class="empty__text">Oops...<br> You have not added anything to your list yet.</p>\n<div class="gallery-library__bg"></div>\n</div>',e.abrupt("return");case 9:a=o(r),console.log(a),v.textOoops.classList.add("visually-hidden"),v.watchedList.innerHTML="",v.watchedList.classList.remove("visually-hidden"),v.watchedList.insertAdjacentHTML("beforeend",a),(0,l.default)();case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}window.addEventListener("load",(function(){v.watchedBtn&&(v.watchedBtn.checked=!0,v.watchedBtn.parentNode.classList.add("checked"))}));var _=a("h4oNJ"),B={libraryListOfWatched:document.querySelector(".gallery-library__list"),btnAddToWatched:document.querySelector(".modal-movie__add-to-watched-btn"),btnQueue:document.querySelector(".modal-movie__add-to-queue-btn")};function O(){return(O=e(o)(e(c).mark((function t(n){var r;return e(c).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.target.dataset.id,(0,_.createArrayLocalStorage)("watched"),(0,_.createArrayLocalStorage)("queue"),(0,_.renameBtn)(B.btnAddToWatched,"watched","Add to watched","Remove from watched",r),(0,_.renameBtn)(B.btnQueue,"queue","Add to queue","Remove from queue",r),k=(0,i.fetchPictures)(r),"IMG"===n.target.nodeName||"P"===n.target.nodeName||"H2"===n.target.nodeName||"H3"===n.target.nodeName||"B"===n.target.nodeName){e.next=8;break}return e.abrupt("return");case 8:(0,d.handleModalOpenClose)(),(0,u.handleApiData)(r),document.body.style.overflow="hidden";case 11:case"end":return e.stop()}}),t)})))).apply(this,arguments)}B.libraryListOfWatched.addEventListener("click",(function(e){return O.apply(this,arguments)})),(0,_.removeLocalStorage)("watched"),(0,_.removeLocalStorage)("queue");var k={},M=document.querySelector(".modal-movie__add-to-watched-btn"),N=document.querySelector(".modal-movie__add-to-queue-btn");M.addEventListener("click",(function(){k.then((function(e){var t=(0,_.loadFromLocalStorage)("watched");if(t.includes(e.id)){var n=t.findIndex((function(t){return t===e.id}));t.splice(n,1),localStorage.setItem("watched",JSON.stringify(t)),(0,_.renameBtnTextCont)(M,"Add to watched"),M.classList.remove("active-btn"),1===p&&S(t)}else t.push(e.id),(0,_.saveToLocalStorage)("watched",t),(0,_.renameBtnTextCont)(M,"Remove from watched"),M.classList.add("active-btn"),1===p&&S(t)}))})),N.addEventListener("click",(function(){k.then((function(e){var t=(0,_.loadFromLocalStorage)("queue");if(t.includes(e.id)){var n=t.findIndex((function(t){return t===e.id}));t.splice(n,1),localStorage.setItem("queue",JSON.stringify(t)),(0,_.renameBtnTextCont)(N,"Add to queue"),N.classList.remove("active-btn"),2===p&&S(t)}else t.push(e.id),(0,_.saveToLocalStorage)("queue",t),(0,_.renameBtnTextCont)(N,"Remove from queue"),N.classList.add("active-btn"),2===p&&S(t)}))}))}();
//# sourceMappingURL=library.914c05e4.js.map
